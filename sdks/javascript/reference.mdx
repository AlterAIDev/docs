---
title: 'Reference'
description: 'Advanced configuration and API reference for Alter Connect'
---

## Session Tokens

Session tokens are temporary credentials that authorize Alter Connect without exposing your API keys.

### Token Properties

| Property | Description | Default |
|----------|-------------|---------|
| **Lifetime** | How long token is valid | 15 minutes |
| **Single use** | Can only create one connection | No |
| **IP restricted** | Locked to user's IP | Optional |
| **Provider list** | Which providers to show | All enabled |

### Creating Secure Sessions

Always create sessions on your backend:

```javascript
// YOUR backend - never expose API keys
const response = await fetch('https://api.alter.com/oauth/connect/session', {
  method: 'POST',
  headers: {
    'x-api-key': process.env.ALTER_API_KEY,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    end_user: {
      id: user.id,
      email: user.email
    },
    attributes: {
      user_id: user.id  // Must match when retrieving tokens
    },
    allowed_providers: ['google', 'slack'],
    settings: {
      expires_in: 900,  // 15 minutes
      single_use: true,
      ip_restriction: req.ip
    }
  })
});
```

## Customization

Alter Connect supports basic visual customization:

```javascript
const alterConnect = AlterConnect.create({
  customization: {
    colors: {
      primary: '#6366f1',     // Button colors
      text: '#111827',        // Text color
      background: '#ffffff'   // Background color
    },
    fontFamily: '"Inter", sans-serif'
  },
  debug: true  // Enable console logging
});
```

### Available Options

| Option | Type | Description |
|--------|------|-------------|
| `colors.primary` | string | Primary button color |
| `colors.text` | string | Text color |
| `colors.background` | string | Background color |
| `fontFamily` | string | Font family |
| `debug` | boolean | Enable console logs |
| `locale` | string | Language (en, es, fr, de) |

## Open Options

Configure the widget when opening:

```javascript
await alterConnect.open({
  // Required
  token: sessionToken,           // From your backend
  onSuccess: (connection) => {}, // Success callback

  // Optional
  onError: (error) => {},        // Error callback
  onClose: () => {},             // Close callback
  provider: 'google',            // Pre-select provider
  container: '#widget',          // Embed in element (vs modal)
  baseURL: 'https://...'        // Override API URL (testing)
});
```

## Connection Object

After successful connection:

```typescript
interface Connection {
  connection_id: string;      // Unique ID for this connection
  provider: string;            // Provider ID (e.g., 'google')
  provider_name: string;       // Display name (e.g., 'Google')
  account_identifier: string;  // User's email/username
  timestamp: string;           // ISO 8601 timestamp
  scopes: string[];           // OAuth scopes granted
  status: 'active' | 'pending' | 'error';
}
```

## Error Handling

Handle errors gracefully:

```javascript
await alterConnect.open({
  token: sessionToken,
  onSuccess: (connection) => {
    // Save connection_id to your database
    saveConnection(connection.connection_id);
  },
  onError: (error) => {
    console.error('Connection failed:', error);

    switch(error.code) {
      case 'user_cancelled':
        // User closed the window
        break;
      case 'token_expired':
        // Session expired - create new one
        break;
      case 'provider_error':
        // OAuth provider issue
        alert('Provider error. Please try again.');
        break;
      default:
        alert('Connection failed. Please try again.');
    }
  }
});
```

## Browser Support

| Browser | Minimum Version |
|---------|----------------|
| Chrome/Edge | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| iOS Safari | 14+ |
| Chrome Mobile | Latest |

## Content Security Policy

If using CSP, add these directives:

```html
<meta http-equiv="Content-Security-Policy"
      content="frame-src https://api.alter.com;
               connect-src https://api.alter.com;
               script-src 'self' https://cdn.jsdelivr.net;">
```

## TypeScript

Full TypeScript support included:

```typescript
import AlterConnect, {
  AlterConnectConfig,
  OpenOptions,
  Connection,
  AlterError
} from '@alter-ai/connect';

const config: AlterConnectConfig = {
  customization: {
    colors: { primary: '#6366f1' }
  }
};

const alterConnect = AlterConnect.create(config);
```

## Methods

### `AlterConnect.create(config?)`

Create an instance with optional configuration.

### `alterConnect.open(options)`

Open the OAuth connection flow. Returns a Promise.

### `alterConnect.close()`

Programmatically close the widget.

### `alterConnect.destroy()`

Clean up and remove event listeners.

## Events

Listen to widget events:

```javascript
alterConnect.on('provider_selected', (provider) => {
  console.log('User selected:', provider);
});

alterConnect.on('connection_started', () => {
  console.log('OAuth flow started');
});

alterConnect.on('connection_complete', (connection) => {
  console.log('Connection successful:', connection);
});
```

## Troubleshooting

### Widget Not Opening

- Verify session token is valid (not expired)
- Check browser console for errors
- Ensure popup blockers are disabled

### Connection Fails

- Verify OAuth app credentials in Developer Portal
- Check redirect URI matches exactly
- Ensure scopes are configured correctly

### Tokens Not Working

- Confirm attribution matches between session and token request
- Verify connection was completed successfully
- Check token hasn't expired (auto-refresh should handle this)

## Security Best Practices

1. **Never expose API keys** - Always create sessions server-side
2. **Use short-lived tokens** - 15 minutes or less
3. **Implement IP restrictions** - Lock sessions to user's IP
4. **Validate on backend** - Always verify connection on your server
5. **Use HTTPS** - Never use in production without HTTPS
